import gdb
gdb.execute("file vm")
gdb.execute("b *0x00005555555565B0")

"""
*RAX  0x1a2c
 RBX  0x0
*RCX  0x1010
*RDX  0x154a


 RAX  0xfca
 RBX  0x0
 RCX  0x1010
 RDX  0x11a3

 RAX  0xfca
 RBX  0x0
 RCX  0x1010
 RDX  0x11a3
 """

# for i in range(1000):
gdb.execute("context")

defaultkotak = [6700, 4042, 5883, 4788, 7124, 8140, 7810, 5350, 2772, 12876, 6460, 7038, 7918, 2496, 17400, 4788, 1050, 11500, 4200, 2976, 3432, 3480, 19032, 8176, 12960, 16200, 8712, 3937, 6930, 11968, 5928, 17280, 13310, 4379, 1380, 7384, 555, 8607, 12584, 5658, 1224, 4785, 5390, 11481, 3773, 3317, 10692, 15408, 1441, 5529, 18860, 5405, 1045, 6272, 13462, 18271, 15836, 8282, 15908, 9760, 8827, 14231, 13344, 532, 5680, 15554, 749, 7808, 4949, 7568, 9462, 8760, 1629, 13800, 9944, 11304, 11712, 3680, 12240, 360, 3400, 11590]

"""

81 [3700, 4515, 6784, 3444, 5252, 9028, 5254, 3750, 3318, 14500, 7548, 8142, 9416, 3216, 13224, 5700, 1160, 12880, 4578, 3360, 4290, 2494, 15006, 5548, 14880, 11760, 10164, 2821, 4818, 9064, 6552, 13500, 9075, 3451, 1545, 9048, 595, 6783, 9504, 6724, 1428, 5225, 5978, 8633, 4214, 3751, 11484, 11556, 1045, 3819, 14835, 5217, 935, 6144, 9398, 12342, 12198, 5822, 10476, 7137, 7760, 12091, 9792, 332, 3680, 11918, 511, 5632, 3969, 5368, 6972, 6120, 1152, 8648, 7040, 9000, 8544, 2520, 8466, 258, 2550, 7885]
81 [6700, 4042, 5883, 4788, 7124, 8140, 7810, 5350, 2772, 12876, 6460, 7038, 7918, 2496, 17400, 4788, 1050, 11500, 4200, 2976, 3432, 3480, 19032, 8176, 12960, 16200, 8712, 3937, 6930, 11968, 5928, 17280, 13310, 4379, 1380, 7384, 555, 8607, 12584, 5658, 1224, 4785, 5390, 11481, 3773, 3317, 10692, 15408, 1441, 5529, 18860, 5405, 1045, 6272, 13462, 18271, 15836, 8282, 15908, 9760, 8827, 14231, 13344, 532, 5680, 15554, 749, 7808, 4949, 7568, 9462, 8760, 1629, 13800, 9944, 11304, 11712, 3680, 12240, 360, 3400, 11590]

81 [3700, 4515, 6784, 3444, 5252, 9028, 5254, 3750, 3318, 14500, 7548, 8142, 9416, 3216, 13224, 5700, 1160, 12880, 4578, 3360, 4290, 2494, 15006, 5548, 14880, 11760, 10164, 2821, 4818, 9064, 6552, 13500, 9075, 3451, 1545, 9048, 595, 6783, 9504, 6724, 1428, 5225, 5978, 8633, 4214, 3751, 11484, 11556, 1045, 3819, 14835, 5217, 935, 6144, 9398, 12342, 12198, 5822, 10476, 7137, 7760, 12091, 9792, 332, 3680, 11918, 511, 5632, 3969, 5368, 6972, 6120, 1152, 8648, 7040, 9000, 8544, 2520, 8466, 258, 2550, 7790]

81 [6700, 4042, 5883, 4788, 7124, 8140, 7810, 5350, 2772, 12876, 6460, 7038, 7918, 2496, 17400, 4788, 1050, 11500, 4200, 2976, 3432, 3480, 19032, 8176, 12960, 16200, 8712, 3937, 6930, 11968, 5928, 17280, 13310, 4379, 1380, 7384, 555, 8607, 12584, 5658, 1224, 4785, 5390, 11481, 3773, 3317, 10692, 15408, 1441, 5529, 18860, 5405, 1045, 6272, 13462, 18271, 15836, 8282, 15908, 9760, 8827, 14231, 13344, 532, 5680, 15554, 749, 7808, 4949, 7568, 9462, 8760, 1629, 13800, 9944, 11304, 11712, 3680, 12240, 360, 3400, 11590]


81 [3750, 4515, 6784, 3444, 5252, 9028, 5254, 3750, 3318, 14500, 7548, 8142, 9416, 3216, 13224, 5700, 1160, 12880, 4578, 3360, 4290, 2494, 15006, 5548, 14880, 11760, 10164, 2821, 4818, 9064, 6552, 13500, 9075, 3451, 1545, 9048, 595, 6783, 9504, 6724, 1428, 5225, 5978, 8633, 4214, 3751, 11484, 11556, 1045, 3819, 14835, 5217, 935, 6144, 9398, 12342, 12198, 5822, 10476, 7137, 7760, 12091, 9792, 332, 3680, 11918, 511, 5632, 3969, 5368, 6972, 6120, 1152, 8648, 7040, 9000, 8544, 2520, 8466, 258, 2550, 7790]
81 [6700, 4042, 5883, 4788, 7124, 8140, 7810, 5350, 2772, 12876, 6460, 7038, 7918, 2496, 17400, 4788, 1050, 11500, 4200, 2976, 3432, 3480, 19032, 8176, 12960, 16200, 8712, 3937, 6930, 11968, 5928, 17280, 13310, 4379, 1380, 7384, 555, 8607, 12584, 5658, 1224, 4785, 5390, 11481, 3773, 3317, 10692, 15408, 1441, 5529, 18860, 5405, 1045, 6272, 13462, 18271, 15836, 8282, 15908, 9760, 8827, 14231, 13344, 532, 5680, 15554, 749, 7808, 4949, 7568, 9462, 8760, 1629, 13800, 9944, 11304, 11712, 3680, 12240, 360, 3400, 11590]


81 [3800, 4515, 6784, 3444, 5252, 9028, 5254, 3750, 3318, 14500, 7548, 8142, 9416, 3216, 13224, 5700, 1160, 12880, 4578, 3360, 4290, 2494, 15006, 5548, 14880, 11760, 10164, 2821, 4818, 9064, 6552, 13500, 9075, 3451, 1545, 9048, 595, 6783, 9504, 6724, 1428, 5225, 5978, 8633, 4214, 3751, 11484, 11556, 1045, 3819, 14835, 5217, 935, 6144, 9398, 12342, 12198, 5822, 10476, 7137, 7760, 12091, 9792, 332, 3680, 11918, 511, 5632, 3969, 5368, 6972, 6120, 1152, 8648, 7040, 9000, 8544, 2520, 8466, 258, 2550, 7790]
81 [6700, 4042, 5883, 4788, 7124, 8140, 7810, 5350, 2772, 12876, 6460, 7038, 7918, 2496, 17400, 4788, 1050, 11500, 4200, 2976, 3432, 3480, 19032, 8176, 12960, 16200, 8712, 3937, 6930, 11968, 5928, 17280, 13310, 4379, 1380, 7384, 555, 8607, 12584, 5658, 1224, 4785, 5390, 11481, 3773, 3317, 10692, 15408, 1441, 5529, 18860, 5405, 1045, 6272, 13462, 18271, 15836, 8282, 15908, 9760, 8827, 14231, 13344, 532, 5680, 15554, 749, 7808, 4949, 7568, 9462, 8760, 1629, 13800, 9944, 11304, 11712, 3680, 12240, 360, 3400, 11590]
"""

import string
brute = string.ascii_letters + string.digits + string.punctuation
brute = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!{}_@#$%&()*+,-./:;<=>?[]^|~'
print(repr(brute))
kamus = dict()
flag = ["A" for i in range(82)]
flag[len(flag) - 1] = "C"
flag = "".join(flag)
pload = flag 

gdb.execute(f"r ./program <<< '{flag}'")
for x in range(len(flag)+1):
    # gdb.execute("context")
    gdb.execute("c")
kotak = []
kotak2 = []
for j in range(82):
    eax = gdb.parse_and_eval("$eax")
    edx = gdb.parse_and_eval("$edx")
    eax = int(eax)
    edx = int(edx)
    kotak.append(edx)
    kotak2.append(eax)

    gdb.execute("set $rdx=$rax")
    gdb.execute("c")
    # break
    print(j, kotak)
    print(j, kotak2)